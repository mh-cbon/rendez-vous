image:
- Visual Studio 2017

environment:
  GOPATH: c:\gopath

install:
  - echo %PATH%
  - set PATH=C:\msys64\mingw64\bin;;%PATH%
  - set PATH=%GOPATH%\bin;%PATH%
  - go get -u github.com/mh-cbon/never-fail
  - never-fail go get -v -u -a -x github.com/mh-cbon/go-libutp
  - go get -u github.com/jessevdk/go-flags
  - go get -u github.com/elazarl/goproxy
  - go get -u github.com/bradfitz/iter
  - go get -u github.com/gorilla/mux
  - go get -u github.com/golang/protobuf/proto
  - go get -u github.com/anacrolix/torrent/bencode
  - go get -u github.com/anacrolix/missinggo
  - go get -u github.com/mh-cbon/rendez-vous

# before_build:
#   # Workaround for CMake not wanting sh.exe on PATH for MinGW
#   - set PATH=%PATH:C:\Program Files (x86)\Git\bin;=%
#   - set PATH=C:\MinGW\bin;%PATH%

build_script:
  - go test
  - go run main.go
